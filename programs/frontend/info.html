<!DOCTYPE html>
<html>
  <head>
	<link href="style.css" rel="stylesheet">
    <title>FanCo</title>
  </head>
  <body>
	<h1 id="fanTitle"></h1>
	<canvas id="line-chart" width="300" height="120"></canvas>
	<div id="control">
		<table id="controlTable">
			<tr>
				<td><p id="soll">◀ Soll: 0rpm ▶</p></td>
				<td><p id="ist">Ist: 0rpm</p></td>
			</tr>
		</table>
	</div>
	<script>
		const chart = require('chart.js');
		const electron = require('electron');
		const  {ipcRenderer} = electron;
		var num;

		var test = new chart(document.getElementById('line-chart'), {
				type: 'line',
				data: {
					labels: [],
					datasets: [{ 
							data: [],
							label: 'RPM',
							borderColor: '#5d275d',
							fill: false
						}
					]
				}
			});
		
		ipcRenderer.send('item:callback', 'load');
		
		ipcRenderer.on('item:fan', function(e, item){
			const fan = document.getElementById('fanTitle');
			fan.innerHTML = 'Fan ' + (item+1);
			num = item;
		});
		ipcRenderer.on('item:rpm', function(e, item){
			const soll = document.getElementById('soll');
			const ist = document.getElementById('ist');
			soll.innerHTML = '◀ Soll: ' + item[num].sollRPM + 'rpm ▶';
			ist.innerHTML = 'Ist: ' + item[num].istRPM + 'rpm';
		});
		ipcRenderer.on('item:data', function(e, item){
			var x = new Array();
			for(var i=0; i<item.length; i++) {
				x[i] = i*2;
			}
			test.data.labels = x;
			test.data.datasets[0].data = item;
			test.update();
		});
	</script>
  </body>
  <footer>
	<div id="foot">
		<table id="footTable">
			<tr>
				<td><p id="avg" id="avg">Ø 2000rpm</p></td>
				<td><p id="pHold">Hold to <b>shutdown</b></p></td>
			</tr>
		</table>
	</div>
  </footer>
</html>